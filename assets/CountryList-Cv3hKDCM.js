import{a as n,j as e}from"./react-BWFZKfll.js";import{g as S}from"./countryService-jQlbHOkd.js";import{C as y}from"./CountryCard-CauQIdCr.js";import"./axios-xsH4HHeE.js";import"./react-router-weGfgXep.js";import"./cookie--_YQFYBD.js";const N=()=>{const[s,f]=n.useState([]),[d,i]=n.useState([]),[l,c]=n.useState(!0),[p,m]=n.useState(null),[o,x]=n.useState(""),[u,g]=n.useState("");n.useEffect(()=>{(async()=>{try{c(!0);const r=[...await S()].sort((h,v)=>h.name.common.localeCompare(v.name.common));f(r),i(r),m(null)}catch(a){m("Maiden tietoja ei voitu ladata. Yritä myöhemmin uudelleen."),console.error(a)}finally{c(!1)}})()},[]);const j=n.useMemo(()=>{const t=new Set(s.map(a=>a.region).sort());return Array.from(t)},[s]),C=async t=>{if(t.preventDefault(),!o&&!u){i(s);return}c(!0),m(null);try{let a=[];o?a=s.filter(r=>r.name.common.toLowerCase().includes(o.toLowerCase())||r.capital&&r.capital.join(", ").toLowerCase().includes(o.toLowerCase())):a=[...s],u&&(a=a.filter(r=>r.region===u)),a=a.sort((r,h)=>r.name.common.localeCompare(h.name.common)),i(a)}catch(a){m("Haussa tapahtui virhe."),console.error(a),i([])}finally{c(!1)}};return l&&d.length===0?e.jsx("p",{children:"Ladataan maita..."}):p?e.jsx("p",{role:"alert",style:{color:"red"},children:p}):e.jsxs("div",{className:"country-list-container",children:[e.jsx("h1",{children:"Tutustu Maailman Maihin"}),e.jsxs("form",{onSubmit:C,className:"filter-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"search-term",children:"Hae maan tai pääkaupungin nimellä:"}),e.jsx("input",{id:"search-term",type:"text",value:o,onChange:t=>x(t.target.value),placeholder:"Hae englannin kielisillä nimillä, esim. Finland tai London"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"region-select",children:"Suodata maanosan mukaan:"}),e.jsxs("select",{id:"region-select",value:u,onChange:t=>g(t.target.value),children:[e.jsx("option",{value:"",children:"Kaikki maanosat"}),j.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsx("button",{type:"submit",disabled:l,children:l?"Haetaan...":"Hae / Suodata"})]}),d.length===0&&!l&&e.jsx("p",{children:"Ei hakutuloksia."}),e.jsx("div",{className:"country-grid","aria-live":"polite",children:d.map(t=>e.jsx(y,{country:t},t.cca3))})]})};export{N as default};
