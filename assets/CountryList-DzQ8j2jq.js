import{r as n,j as e,L as S}from"./index-CL9d_0sK.js";import{g as k}from"./countryService-BphEq_ek.js";const N=()=>{const[i,f]=n.useState([]),[d,l]=n.useState([]),[o,c]=n.useState(!0),[p,m]=n.useState(null),[r,x]=n.useState(""),[u,g]=n.useState("");n.useEffect(()=>{(async()=>{try{c(!0);const s=[...await k()].sort((h,C)=>h.name.common.localeCompare(C.name.common));f(s),l(s),m(null)}catch(t){m("Maiden tietoja ei voitu ladata. Yritä myöhemmin uudelleen."),console.error(t)}finally{c(!1)}})()},[]);const j=n.useMemo(()=>{const a=new Set(i.map(t=>t.region).sort());return Array.from(a)},[i]),v=async a=>{if(a.preventDefault(),!r&&!u){l(i);return}c(!0),m(null);try{let t=[];r?t=i.filter(s=>s.name.common.toLowerCase().includes(r.toLowerCase())||s.capital&&s.capital.join(", ").toLowerCase().includes(r.toLowerCase())):t=[...i],u&&(t=t.filter(s=>s.region===u)),t=t.sort((s,h)=>s.name.common.localeCompare(h.name.common)),l(t)}catch(t){m("Haussa tapahtui virhe."),console.error(t),l([])}finally{c(!1)}};return o&&d.length===0?e.jsx("p",{children:"Ladataan maita..."}):p?e.jsx("p",{role:"alert",style:{color:"red"},children:p}):e.jsxs("div",{className:"country-list-container",children:[e.jsx("h1",{children:"Tutustu Maailman Maihin"}),e.jsxs("form",{onSubmit:v,className:"filter-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"search-term",children:"Hae maan tai pääkaupungin nimellä:"}),e.jsx("input",{id:"search-term",type:"text",value:r,onChange:a=>x(a.target.value),placeholder:"Hae englannin kielisillä nimillä, esim. Finland tai London"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"region-select",children:"Suodata maanosan mukaan:"}),e.jsxs("select",{id:"region-select",value:u,onChange:a=>g(a.target.value),children:[e.jsx("option",{value:"",children:"Kaikki maanosat"}),j.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsx("button",{type:"submit",disabled:o,children:o?"Haetaan...":"Hae / Suodata"})]}),d.length===0&&!o&&e.jsx("p",{children:"Ei hakutuloksia."}),e.jsx("div",{className:"country-grid","aria-live":"polite",children:d.map(a=>{var t;return e.jsxs(S,{to:`/country/${a.cca3}`,className:"country-card",children:[e.jsx("img",{src:a.flags.svg,alt:`Lippu: ${a.name.common}`,loading:"lazy"}),e.jsxs("div",{className:"card-content",children:[e.jsx("h2",{children:a.name.common}),e.jsxs("p",{children:["Pääkaupunki: ",((t=a.capital)==null?void 0:t[0])||"Ei tietoa"]}),e.jsxs("p",{children:["Väkiluku: ",a.population.toLocaleString("fi-FI")]}),e.jsxs("p",{children:["Maanosa: ",a.region]})]})]},a.cca3)})})]})};export{N as default};
