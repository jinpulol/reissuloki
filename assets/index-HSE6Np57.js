import{j as e,a as i}from"./react-BWFZKfll.js";import{c as C}from"./react-dom-B0g7UFVY.js";import{a as L}from"./axios-xsH4HHeE.js";import{L as S}from"./react-router-BNmLyaNj.js";import"./scheduler-SPyfQU6S.js";import"./cookie--_YQFYBD.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function d(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(t){if(t.ep)return;t.ep=!0;const a=d(t);fetch(t.href,a)}})();const E="https://restcountries.com/v3.1",b=async()=>{try{return(await L.get(`${E}/all?fields=name,cca3,flags,population,region,capital`)).data}catch(r){throw console.error("Error fetching all countries summary:",r),r}},N=({country:r})=>{var l;return e.jsxs(S,{to:`/country/${r.cca3}`,className:"country-card",children:[e.jsx("img",{src:r.flags.svg,alt:`Lippu: ${r.name.common}`,loading:"lazy"}),e.jsxs("div",{className:"card-content",children:[e.jsx("h2",{children:r.name.common}),e.jsxs("p",{children:["Pääkaupunki: ",((l=r.capital)==null?void 0:l[0])||"Ei tietoa"]}),e.jsxs("p",{children:["Väkiluku: ",r.population.toLocaleString("fi-FI")]}),e.jsxs("p",{children:["Maanosa: ",r.region]})]})]})},w=()=>{const[r,l]=i.useState([]),[d,c]=i.useState([]),[t,a]=i.useState(!0),[u,p]=i.useState(null),[m,g]=i.useState(""),[f,x]=i.useState("");i.useEffect(()=>{(async()=>{try{a(!0);const o=[...await b()].sort((h,v)=>h.name.common.localeCompare(v.name.common));l(o),c(o),p(null)}catch(n){p("Maiden tietoja ei voitu ladata. Yritä myöhemmin uudelleen."),console.error(n)}finally{a(!1)}})()},[]);const j=i.useMemo(()=>{const s=new Set(r.map(n=>n.region).sort());return Array.from(s)},[r]),y=async s=>{if(s.preventDefault(),!m&&!f){c(r);return}a(!0),p(null);try{let n=[];m?n=r.filter(o=>o.name.common.toLowerCase().includes(m.toLowerCase())||o.capital&&o.capital.join(", ").toLowerCase().includes(m.toLowerCase())):n=[...r],f&&(n=n.filter(o=>o.region===f)),n=n.sort((o,h)=>o.name.common.localeCompare(h.name.common)),c(n)}catch(n){p("Haussa tapahtui virhe."),console.error(n),c([])}finally{a(!1)}};return t&&d.length===0?e.jsx("p",{children:"Ladataan maita..."}):u?e.jsx("p",{role:"alert",style:{color:"red"},children:u}):e.jsxs("div",{className:"country-list-container",children:[e.jsx("h1",{children:"Tutustu Maailman Maihin"}),e.jsxs("form",{onSubmit:y,className:"filter-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"search-term",children:"Hae maan tai pääkaupungin nimellä:"}),e.jsx("input",{id:"search-term",type:"text",value:m,onChange:s=>g(s.target.value),placeholder:"Hae englannin kielisillä nimillä, esim. Finland tai London"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"region-select",children:"Suodata maanosan mukaan:"}),e.jsxs("select",{id:"region-select",value:f,onChange:s=>x(s.target.value),children:[e.jsx("option",{value:"",children:"Kaikki maanosat"}),j.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsx("button",{type:"submit",disabled:t,children:t?"Haetaan...":"Hae / Suodata"})]}),d.length===0&&!t&&e.jsx("p",{children:"Ei hakutuloksia."}),e.jsx("div",{className:"country-grid","aria-live":"polite",children:d.map(s=>e.jsx(N,{country:s},s.cca3))})]})};function k(){return e.jsx("div",{children:e.jsx(i.Suspense,{fallback:e.jsx("div",{style:{minHeight:350,display:"flex",alignItems:"center",justifyContent:"center"},children:"Ladataan..."}),children:e.jsx(w,{})})})}C.createRoot(document.getElementById("root")).render(e.jsx(i.StrictMode,{children:e.jsx(k,{})}));
